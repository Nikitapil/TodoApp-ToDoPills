let modalContainer=document.querySelector(".modal__container");function showModal(e){modalContainer.classList.toggle("hidden"),e.classList.toggle("hidden")}let todoContainer=document.querySelector(".todo__container");localStorage.getItem("elements")&&(todoContainer.innerHTML=localStorage.getItem("elements"));let addButton=document.querySelector(".todo__addBtn"),addModal=document.querySelector(".modal__add"),addModalCancel=document.querySelector(".modal__cancel__addbtn");addButton.addEventListener("click",()=>showModal(addModal)),addModalCancel.addEventListener("click",()=>showModal(addModal));let addItemBtn=document.querySelector(".modal__add__addbtn"),titleInput=document.querySelector(".todo__title__input"),descriptionInput=document.querySelector(".todo__comment__input"),mainBlock=document.querySelector(".todo__main__content");function addItem(){let e=document.createElement("div");e.draggable=!0;let t=new Date,o=t.getDate()+"."+(t.getMonth()+1)+"."+t.getFullYear();e.classList.add("todo__item"),e.innerHTML=`<h4 class="todo__item__header">${titleInput.value}</h4>\n    <div class="todo__item__buttons">\n        <button class="inprogress__button" title="В процессе"></button>\n        <button class="delete__button" title="Удалить"></button>\n        <button class="inmain__button" title="В невыполненные"></button>\n        <button class="indone__button" title="В выполненные"></button>\n    </div>\n    <p class="todo__item__description">${descriptionInput.value}</p>\n    <p class="todo__item__date">${o}</p>\n    <button class="item__show"><span>Показать</span></button>`,mainBlock.append(e),showModal(addModal),localStorage.setItem("elements",todoContainer.innerHTML),counters()}addItemBtn.addEventListener("click",addItem);let inprogressBlock=document.querySelector(".todo__inprogress__content"),doneBlock=document.querySelector(".todo__done__content"),trashBlock=document.querySelector(".todo__trash__content"),deleteModal=document.querySelector(".modal__delete"),delCancelBtn=document.querySelector(".modal__delete__cancelbtn");function changeBlock(e,t){let o=e.closest(".todo__item");t.append(o),localStorage.setItem("elements",todoContainer.innerHTML),counters()}delCancelBtn.addEventListener("click",()=>showModal(deleteModal)),todoContainer.addEventListener("click",(function(e){if(e.target.classList.contains("inprogress__button"))changeBlock(e.target,inprogressBlock);else if(e.target.classList.contains("inmain__button"))changeBlock(e.target,mainBlock);else if(e.target.classList.contains("indone__button"))changeBlock(e.target,doneBlock);else if(e.target.classList.contains("delete__button"))if(e.target.closest(".todo__item").parentElement.classList.contains("todo__trash__content")){showModal(deleteModal),document.querySelector(".modal__delete__deletebtn").onclick=function(){e.target.closest(".todo__item").remove(),localStorage.setItem("elements",todoContainer.innerHTML),counters(),showModal(deleteModal)}}else changeBlock(e.target,trashBlock);else e.target.classList.contains("todo__clear")&&(e.target.closest(".todo__block").querySelector(".todo__content").innerHTML="",localStorage.setItem("elements",todoContainer.innerHTML),counters())}));let todoBlocks=document.querySelectorAll(".todo__block");function counters(){todoBlocks.forEach(e=>{let t=e.querySelector(".todo__counter"),o=e.querySelector(".todo__content");t.textContent=o.children.length})}todoBlocks.forEach(e=>{e.addEventListener("dragstart",(function(e){e.target.classList.add("dragnow")})),e.addEventListener("dragend",(function(e){e.target.classList.remove("dragnow")})),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("drop",(function(t){t.preventDefault();let o=document.querySelector(".dragnow");if(null!=o){e.querySelector(".todo__content").append(o)}counters()}))}),counters();let editModal=document.querySelector(".modal__edit");todoContainer.addEventListener("click",(function(e){if(e.target.classList.contains("item__show")){let t=e.target.closest(".todo__item").querySelector(".todo__item__header").textContent,o=e.target.closest(".todo__item").querySelector(".todo__item__description").textContent;editModal.innerHTML=`\n    <h2>${t}</h2>\n            <p>${o}</p>\n            <div class="modal__edit__buttons">\n                <button type="button" class="modal__edit__editbtn">Редактировать</button>\n                <button type="button" class="modal__cancel__editbtn">Закрыть</button>\n            </div>\n    `,document.querySelector(".modal__cancel__editbtn").addEventListener("click",()=>showModal(editModal)),document.querySelector(".modal__edit__editbtn").onclick=function(){editModal.innerHTML=`\n        <label for="edit__header">Название</label>\n    <input type="text" value="${t}" id="edit__header">\n    <label for="edit__comment">Описание</label>\n            <textarea id="edit__comment">${o}</textarea>\n            <div class="modal__edit__buttons">\n                <button type="button" class="modal__save__editbtn">Сохранить</button>\n                <button type="button" class="modal__cancel__editbtn">Закрыть</button>\n            </div>\n    `,document.querySelector(".modal__cancel__editbtn").addEventListener("click",()=>showModal(editModal));let n=document.getElementById("edit__header"),d=document.getElementById("edit__comment");document.querySelector(".modal__save__editbtn").addEventListener("click",(function(){e.target.closest(".todo__item").querySelector(".todo__item__header").textContent=n.value,e.target.closest(".todo__item").querySelector(".todo__item__description").textContent=d.value,localStorage.setItem("elements",todoContainer.innerHTML),showModal(editModal)}))},showModal(editModal)}}));let aboutBtn=document.querySelector(".about__btn"),aboutModal=document.querySelector(".modal__about"),aboutCloseBtn=document.querySelector(".modal__about__closeBtn");aboutBtn.addEventListener("click",()=>showModal(aboutModal)),aboutCloseBtn.addEventListener("click",()=>showModal(aboutModal));let instructionBtn=document.querySelector(".instruction__btn"),instructionModal=document.querySelector(".modal__instruction"),instructionCloseBtn=document.querySelector(".modal__instruction__closeBtn");instructionBtn.addEventListener("click",()=>showModal(instructionModal)),instructionCloseBtn.addEventListener("click",()=>showModal(instructionModal));let burgerMenu=document.querySelector(".burgermenu"),navMenu=document.querySelector(".header_nav_list"),headerNav=document.querySelector(".header_nav");burgerMenu.onclick=function(){burgerMenu.classList.toggle("active"),navMenu.classList.toggle("burgernav"),burgerMenu.classList.contains("active")?headerNav.style.display="block":headerNav.style.display="none"};let searchBtn=document.querySelector(".todo__searchbutton"),searchInput=document.querySelector(".todo__searchInput"),searchModal=document.querySelector(".modal__search");searchBtn.onclick=function(){let e=document.querySelectorAll(".todo__item"),t=searchModal.innerHTML,o=Array.from(e).filter(e=>e.querySelector(".todo__item__header").textContent==searchInput.value).map(e=>{let t=e.cloneNode(!0);return t.querySelectorAll("button").forEach(e=>e.remove()),t});o.length>0?(showModal(searchModal),searchModal.append(...o)):alert("Ничего не найдено"),document.querySelector(".modal__search__closeBtn").onclick=function(){searchModal.innerHTML=t,showModal(searchModal)}};